# Spec 038: Curiosity Triggers Display (Further Questions)

**Feature**: Display AI-generated curiosity questions as clickable exploration chips
**Type**: Component Enhancement (adds to existing pages, no new routes)
**Priority**: P0 (Critical - Quick Win!)
**Complexity**: Low
**Timeline**: 1 week

---

## Problem Statement

### Current State
- **Backend ALREADY generates** curiosity triggers during document processing
- Data exists in `document.research.curiosity_triggers` (array of questions)
- **Frontend NEVER displays them** - completely hidden intelligence!
- Users don't know what further questions to explore
- Consciousness-driven curiosity system is invisible

### The Irony
✅ **95% Done**: Backend generates intelligent questions via R-Zero co-evolution
❌ **5% Missing**: No UI to show them to users!

### User Pain Points
1. **Hidden Intelligence**: Don't see what questions the system generated
2. **No Exploration**: Can't easily explore related topics
3. **Dead End**: After reading document, unclear what to do next
4. **Lost Value**: Curiosity system value completely hidden

### What We're NOT Changing
✅ Keep all existing pages/routes
✅ Keep existing CuriosityMissions page (`/curiosity`)
✅ Keep existing document processing
✅ Keep existing data structures

---

## Solution Overview

### Add Component to Existing Pages
**Where**: DocumentDetail (`/document/:id`) and Reader (`/reader/:id`)
**What**: "Further Questions" section at bottom of page
**How**: Clickable question chips (SurfSense pattern)

**Visual Design**:
```
┌─────────────────────────────────────────────────┐
│ Document Content Above                          │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│ 🔍 Further Questions                             │
│                                                  │
│ Questions generated by curiosity system:         │
│                                                  │
│ ┌────────────────────────────────────────────┐ │
│ │ How do neural networks exhibit emergence?  │ │
│ │ 🧠 Prediction Error: 0.73 | Basin: Emergent│ │
│ └────────────────────────────────────────────┘ │
│                                                  │
│ ┌────────────────────────────────────────────┐ │
│ │ What mechanisms enable consciousness?       │ │
│ │ 🧠 Prediction Error: 0.68 | Basin: Conscious│ │
│ └────────────────────────────────────────────┘ │
│                                                  │
│ ┌────────────────────────────────────────────┐ │
│ │ How does basin strengthening work?          │ │
│ │ 🧠 Prediction Error: 0.45 | Basin: Basins   │ │
│ └────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

**User Flow**:
```
1. User reads document
2. Scrolls to "Further Questions" section
3. Sees 3-5 curiosity-generated questions
4. Clicks question chip
5. Navigate to /curiosity with that question as seed
   → Triggers new consciousness-enhanced research
```

---

## Functional Requirements

### FR-001: Display Curiosity Triggers
**Description**: Show questions from backend in UI

**Acceptance Criteria**:
- [ ] Display questions from `document.research.curiosity_triggers`
- [ ] Show up to 5 questions (sorted by prediction_error desc)
- [ ] Each question as clickable chip/card
- [ ] Show prediction error magnitude (visual indicator)
- [ ] Show associated basin (if available)
- [ ] Graceful handling if no questions (show "No further questions generated")

**Data Source**:
```typescript
// Backend already provides this!
document.research.curiosity_triggers: Array<{
  question: string
  error_magnitude: number  // 0.0-1.0 (higher = more curious)
  basin_context?: string   // Which basin triggered this
  concept?: string         // Related concept
}>
```

### FR-002: Interactive Question Chips
**Description**: Questions are clickable to trigger research

**Acceptance Criteria**:
- [ ] Click question → navigate to research page
- [ ] Pass question as URL param: `/curiosity?q={encoded_question}`
- [ ] CuriosityMissions page receives question as seed
- [ ] Visual feedback on hover (highlight, cursor pointer)
- [ ] Keyboard accessible (tab navigation, enter to click)

**Implementation**:
```tsx
<div className="question-chip" onClick={() => {
  navigate(`/curiosity?q=${encodeURIComponent(trigger.question)}`)
}}>
  <p className="question-text">{trigger.question}</p>
  <div className="question-meta">
    <span>🧠 Error: {trigger.error_magnitude.toFixed(2)}</span>
    {trigger.basin_context && (
      <span>Basin: {trigger.basin_context}</span>
    )}
  </div>
</div>
```

### FR-003: Prediction Error Visualization
**Description**: Visual indicator of curiosity strength

**Acceptance Criteria**:
- [ ] Color gradient based on error_magnitude (0.0-1.0)
  - Low (0.0-0.3): Gray/subtle
  - Medium (0.3-0.6): Blue
  - High (0.6-1.0): Purple/vibrant
- [ ] Border thickness indicates strength
- [ ] Tooltip shows exact prediction error value
- [ ] Icon changes based on magnitude (lightbulb → spark → fire)

**Visual Mapping**:
```css
/* Low curiosity */
.curiosity-low {
  border: 1px solid rgba(156, 163, 175, 0.5);
  background: rgba(156, 163, 175, 0.05);
}

/* Medium curiosity */
.curiosity-medium {
  border: 2px solid rgba(59, 130, 246, 0.5);
  background: rgba(59, 130, 246, 0.1);
}

/* High curiosity */
.curiosity-high {
  border: 3px solid rgba(168, 85, 247, 0.7);
  background: rgba(168, 85, 247, 0.15);
  box-shadow: 0 0 20px rgba(168, 85, 247, 0.2);
}
```

### FR-004: Basin Context Display
**Description**: Show which basin triggered the question

**Acceptance Criteria**:
- [ ] Display basin name if available in trigger data
- [ ] Basin name is clickable → navigate to basin detail
- [ ] Visual distinction from question text (smaller, muted)
- [ ] Tooltip shows basin strength/metadata
- [ ] Handle missing basin gracefully (don't show if not available)

### FR-005: Fallback States
**Description**: Handle edge cases gracefully

**Acceptance Criteria**:
- [ ] No questions: Show "No further questions generated"
- [ ] Loading state while fetching document
- [ ] Error state if data fetch fails
- [ ] Empty array: Show default curiosity mission link
- [ ] Partial data: Show available fields, hide missing

---

## Non-Functional Requirements

### NFR-001: Performance
- Rendering: <50ms for 10 questions
- No impact on page load time (data already fetched)
- Smooth animations (60fps)

### NFR-002: Accessibility
- Keyboard navigation (tab through chips)
- Screen reader support (ARIA labels)
- High contrast mode support
- Focus indicators visible

### NFR-003: Responsive Design
- Desktop: 3 columns of chips
- Tablet: 2 columns
- Mobile: 1 column (stack vertically)
- Touch targets: Minimum 44x44px

---

## Technical Design

### Component Architecture
```tsx
// New Component: FurtherQuestions.tsx
interface FurtherQuestionsProps {
  triggers: Array<{
    question: string
    error_magnitude: number
    basin_context?: string
    concept?: string
  }>
  onQuestionClick?: (question: string) => void
}

export function FurtherQuestions({ triggers, onQuestionClick }: FurtherQuestionsProps) {
  const navigate = useNavigate()

  const handleClick = (question: string) => {
    if (onQuestionClick) {
      onQuestionClick(question)
    } else {
      navigate(`/curiosity?q=${encodeURIComponent(question)}`)
    }
  }

  if (!triggers || triggers.length === 0) {
    return (
      <div className="no-questions">
        <p>No further questions generated for this document.</p>
        <Button onClick={() => navigate('/curiosity')}>
          Explore Curiosity Missions
        </Button>
      </div>
    )
  }

  // Sort by error_magnitude desc, take top 5
  const topQuestions = triggers
    .sort((a, b) => b.error_magnitude - a.error_magnitude)
    .slice(0, 5)

  return (
    <div className="further-questions">
      <h3>🔍 Further Questions</h3>
      <p className="description">
        Questions generated by our curiosity system based on prediction errors:
      </p>

      <div className="questions-grid">
        {topQuestions.map((trigger, index) => (
          <QuestionChip
            key={index}
            question={trigger.question}
            errorMagnitude={trigger.error_magnitude}
            basinContext={trigger.basin_context}
            onClick={() => handleClick(trigger.question)}
          />
        ))}
      </div>
    </div>
  )
}
```

### Integration Points

**1. DocumentDetail Page**:
```tsx
// In DocumentDetail.tsx
import { FurtherQuestions } from '../components/FurtherQuestions'

// Inside component render
<div className="document-detail">
  {/* Existing content */}

  {/* ADD THIS at bottom */}
  {document?.research?.curiosity_triggers && (
    <FurtherQuestions
      triggers={document.research.curiosity_triggers}
    />
  )}
</div>
```

**2. Reader Page (Spec 037)**:
```tsx
// In Reader.tsx (once created)
import { FurtherQuestions } from '../components/FurtherQuestions'

// After main content
<FurtherQuestions
  triggers={document.research.curiosity_triggers}
/>
```

**3. CuriosityMissions Page (receive question)**:
```tsx
// In CuriosityMissions.tsx
import { useSearchParams } from 'react-router-dom'

const [searchParams] = useSearchParams()
const seedQuestion = searchParams.get('q')

// If seedQuestion exists, use it to trigger new research
useEffect(() => {
  if (seedQuestion) {
    // Trigger consciousness-enhanced research with this question
    triggerCuriosityResearch(seedQuestion)
  }
}, [seedQuestion])
```

---

## User Stories

### Story 1: Question Discovery
**As a** user
**I want to** see questions generated from the document
**So that** I can explore related topics

**Acceptance**: Questions displayed below document content, clickable

### Story 2: Curiosity-Driven Exploration
**As a** user
**I want to** click a question to trigger new research
**So that** I can dive deeper into interesting topics

**Acceptance**: Click question → navigate to /curiosity with that question

### Story 3: Understanding Curiosity
**As a** user
**I want to** see prediction error magnitude
**So that** I understand which questions are most intriguing

**Acceptance**: Visual indicator (color, border) shows curiosity strength

### Story 4: Basin Connection
**As a** user
**I want to** see which basin triggered the question
**So that** I understand the consciousness context

**Acceptance**: Basin name displayed, clickable to basin detail

---

## Testing Strategy

### Unit Tests
- [ ] FurtherQuestions component renders with data
- [ ] QuestionChip handles click events
- [ ] Prediction error visualization (color mapping)
- [ ] Fallback states (no data, empty array)

### Integration Tests
- [ ] DocumentDetail → FurtherQuestions integration
- [ ] Question click → CuriosityMissions navigation
- [ ] URL param passing (question encoding)
- [ ] Basin context linking

### E2E Tests
- [ ] Full flow: Document → Question → Research
- [ ] Mobile responsiveness
- [ ] Keyboard navigation

---

## Success Metrics

### Engagement
- **Target**: 50% of users click at least one question
- **Measure**: Click-through rate on question chips

### Discovery
- **Target**: 30% of curiosity missions start from question clicks
- **Measure**: `/curiosity?q=` page views vs organic `/curiosity`

### User Satisfaction
- **Target**: 4.2/5 rating for question usefulness
- **Measure**: In-app feedback survey

---

## Future Enhancements (Out of Scope)

### Phase 2
- [ ] Question refinement (user edits question before researching)
- [ ] Question voting (upvote/downvote interesting questions)
- [ ] Question history (see questions from all documents)
- [ ] Generate MORE questions on demand (LLM call)

### Phase 3
- [ ] Question answering (AI answers inline without leaving page)
- [ ] Question threading (follow-up questions based on initial)
- [ ] Collaborative questions (multi-user question suggestions)

---

## Dependencies

### Backend (Already Complete!)
✅ Curiosity triggers generated in LangGraph workflow
✅ Data structure stable (`research.curiosity_triggers`)
✅ No API changes needed

### Frontend (Minimal Changes)
- New component: `FurtherQuestions.tsx`
- Update: `DocumentDetail.tsx` (add component)
- Update: `Reader.tsx` (add component, once created)
- Update: `CuriosityMissions.tsx` (handle URL param)

### External Libraries
- None! Use existing React, React Router, Tailwind

---

## Open Questions

1. **Question Limit**: Show top 3, 5, or 10 questions?
   - **Proposal**: Top 5 by default, "Show More" expands to 10

2. **Question Priority**: Sort by error_magnitude or other factors?
   - **Proposal**: Primary sort by error_magnitude, secondary by novelty

3. **Visual Style**: Match SurfSense chips or custom design?
   - **Proposal**: Custom design with consciousness context (basin colors)

4. **Navigation**: New tab or same tab when clicking question?
   - **Proposal**: Same tab to maintain flow, user can Cmd+Click for new tab

---

## Appendix: SurfSense Comparison

### What We Adopt from SurfSense
✅ Clickable question chips pattern
✅ "Further Questions" section placement
✅ AI-generated question display

### What We Add Beyond SurfSense
🎯 Prediction error visualization (curiosity strength)
🎯 Basin context display (consciousness link)
🎯 Questions already generated (no LLM call needed!)
🎯 Integrated with R-Zero co-evolution system

### Why This is a Quick Win
- **Backend**: Already done (questions generated)
- **Frontend**: Just UI component (1 day work)
- **Impact**: Huge value unlock (hidden intelligence → visible)
- **Risk**: Minimal (no complex logic, just display)

---

## Implementation Checklist

### Week 1: Component Development
- [ ] Day 1: Create `FurtherQuestions.tsx` component
- [ ] Day 2: Create `QuestionChip.tsx` with styling
- [ ] Day 3: Add to DocumentDetail page
- [ ] Day 4: Update CuriosityMissions to handle URL param
- [ ] Day 5: Testing + polish

### Week 2: Enhancement & Launch
- [ ] Day 1: Add to Reader page (Spec 037)
- [ ] Day 2: Accessibility improvements
- [ ] Day 3: Mobile responsive fixes
- [ ] Day 4: User testing
- [ ] Day 5: Launch + monitor metrics
